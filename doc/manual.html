<!DOCTYPE html>
<html>

<head>
  <meta charset="utf-8">
  <meta name="viewport" content="width=device-width, initial-scale=1.0">
  <title>README.md</title>
  <link rel="stylesheet" href="https://stackedit.io/style.css" />
</head>

<body class="stackedit">
  <div class="stackedit__left">
    <div class="stackedit__toc">
      
<ul>
<li><a href="#parallel-on-fredkin-koehler-solver">Parallel O(N) Fredkin-Koehler Solver</a>
<ul>
<li></li>
<li><a href="#installation">Installation</a></li>
<li><a href="#machinery">Machinery</a></li>
<li><a href="#algorithm">Algorithm</a></li>
<li><a href="#contributors">Contributors</a></li>
<li><a href="#project-supervisor">Project supervisor</a></li>
<li><a href="#license">License</a></li>
<li><a href="#create-your-own-app">Create your own app</a></li>
</ul>
</li>
</ul>

    </div>
  </div>
  <div class="stackedit__right">
    <div class="stackedit__html">
      <h1 id="parallel-on-fredkin-koehler-solver">Parallel O(N) Fredkin-Koehler Solver</h1>
<h3 id="introduction">Introduction</h3>
<p>Fredkin-Koehler method is a numerical method to compute electrostatic/magnetic potential inside ferroelectric/ferromagnetic bodies. It is a hybrid method that combines finite element and boundary integral methods. The boundary integration in the original method has <span class="katex--inline"><span class="katex"><span class="katex-mathml"><math><semantics><mrow><mi>O</mi><mo>(</mo><msup><mi>N</mi><mn>2</mn></msup><mo>)</mo></mrow><annotation encoding="application/x-tex">O(N^2)</annotation></semantics></math></span><span class="katex-html" aria-hidden="true"><span class="strut" style="height: 0.814108em;"></span><span class="strut bottom" style="height: 1.06411em; vertical-align: -0.25em;"></span><span class="base"><span style="margin-right: 0.02778em;" class="mord mathit">O</span><span class="mopen">(</span><span class="mord"><span style="margin-right: 0.10903em;" class="mord mathit">N</span><span class="msupsub"><span class="vlist-t"><span class="vlist-r"><span class="vlist" style="height: 0.814108em;"><span class="" style="top: -3.063em; margin-right: 0.05em;"><span class="pstrut" style="height: 2.7em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mathrm mtight">2</span></span></span></span></span></span></span></span><span class="mclose">)</span></span></span></span></span> scaling, where <span class="katex--inline"><span class="katex"><span class="katex-mathml"><math><semantics><mrow><mi>N</mi></mrow><annotation encoding="application/x-tex">N</annotation></semantics></math></span><span class="katex-html" aria-hidden="true"><span class="strut" style="height: 0.68333em;"></span><span class="strut bottom" style="height: 0.68333em; vertical-align: 0em;"></span><span class="base"><span style="margin-right: 0.10903em;" class="mord mathit">N</span></span></span></span></span> is number of unknowns in the discretized mesh. The governing equation is shown as follows, (<em>to view the equations and this manual more clearly, please use the manual.html in <a href="https://github.com/xikaij/fredkin-koehler/tree/master/doc">doc</a> folder</em>)</p>
<p><span class="katex--inline"><span class="katex"><span class="katex-mathml"><math><semantics><mrow><msup><mi mathvariant="normal">∇</mi><mn>2</mn></msup><mi>ϕ</mi><mo>(</mo><mrow><mi mathvariant="bold">x</mi></mrow><mo>)</mo><mo>=</mo><mn>4</mn><mi>π</mi><mi mathvariant="normal">∇</mi><mo>⋅</mo><mrow><mi mathvariant="bold">M</mi><mo>(</mo><mrow><mi mathvariant="bold">x</mi></mrow><mo>)</mo></mrow><mspace width="1em"></mspace></mrow><annotation encoding="application/x-tex">\nabla^2 \phi(\bold{x})=4 \pi \nabla \cdot \bold{M(\bold{x})} \quad</annotation></semantics></math></span><span class="katex-html" aria-hidden="true"><span class="strut" style="height: 0.814108em;"></span><span class="strut bottom" style="height: 1.06411em; vertical-align: -0.25em;"></span><span class="base"><span class="mord"><span class="mord mathrm">∇</span><span class="msupsub"><span class="vlist-t"><span class="vlist-r"><span class="vlist" style="height: 0.814108em;"><span class="" style="top: -3.063em; margin-right: 0.05em;"><span class="pstrut" style="height: 2.7em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mathrm mtight">2</span></span></span></span></span></span></span></span><span class="mord mathit">ϕ</span><span class="mopen">(</span><span class="mord"><span class="mord mathbf">x</span></span><span class="mclose">)</span><span class="mrel">=</span><span class="mord mathrm">4</span><span style="margin-right: 0.03588em;" class="mord mathit">π</span><span class="mord mathrm">∇</span><span class="mbin">⋅</span><span class="mord"><span class="mord mathbf">M</span><span class="mopen">(</span><span class="mord"><span class="mord mathbf">x</span></span><span class="mclose">)</span></span><span class="mspace quad"></span></span></span></span></span> for <span class="katex--inline"><span class="katex"><span class="katex-mathml"><math><semantics><mrow><mrow><mi mathvariant="bold">x</mi></mrow><mo>∈</mo><msub><mi>R</mi><mi>m</mi></msub></mrow><annotation encoding="application/x-tex">\bold{x}\in R_m</annotation></semantics></math></span><span class="katex-html" aria-hidden="true"><span class="strut" style="height: 0.68333em;"></span><span class="strut bottom" style="height: 0.83333em; vertical-align: -0.15em;"></span><span class="base"><span class="mord"><span class="mord mathbf">x</span></span><span class="mrel">∈</span><span class="mord"><span style="margin-right: 0.00773em;" class="mord mathit">R</span><span class="msupsub"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height: 0.151392em;"><span class="" style="top: -2.55em; margin-left: -0.00773em; margin-right: 0.05em;"><span class="pstrut" style="height: 2.7em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mathit mtight">m</span></span></span></span><span class="vlist-s">​</span></span><span class="vlist-r"><span class="vlist" style="height: 0.15em;"></span></span></span></span></span></span></span></span></span>,</p>
<p><span class="katex--inline"><span class="katex"><span class="katex-mathml"><math><semantics><mrow><msup><mi mathvariant="normal">∇</mi><mn>2</mn></msup><mi>ϕ</mi><mo>(</mo><mrow><mi mathvariant="bold">x</mi></mrow><mo>)</mo><mo>=</mo><mn>0</mn><mspace width="2em"></mspace><mspace width="2em"></mspace><mspace width="1em"></mspace></mrow><annotation encoding="application/x-tex">\nabla^2 \phi(\bold{x})=0 \qquad \qquad \quad</annotation></semantics></math></span><span class="katex-html" aria-hidden="true"><span class="strut" style="height: 0.814108em;"></span><span class="strut bottom" style="height: 1.06411em; vertical-align: -0.25em;"></span><span class="base"><span class="mord"><span class="mord mathrm">∇</span><span class="msupsub"><span class="vlist-t"><span class="vlist-r"><span class="vlist" style="height: 0.814108em;"><span class="" style="top: -3.063em; margin-right: 0.05em;"><span class="pstrut" style="height: 2.7em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mathrm mtight">2</span></span></span></span></span></span></span></span><span class="mord mathit">ϕ</span><span class="mopen">(</span><span class="mord"><span class="mord mathbf">x</span></span><span class="mclose">)</span><span class="mrel">=</span><span class="mord mathrm">0</span><span class="mspace qquad"></span><span class="mspace qquad"></span><span class="mspace quad"></span></span></span></span></span> for <span class="katex--inline"><span class="katex"><span class="katex-mathml"><math><semantics><mrow><mrow><mi mathvariant="bold">x</mi></mrow><mo>∈</mo><msub><mi>R</mi><mi>e</mi></msub></mrow><annotation encoding="application/x-tex">\bold{x}\in R_e</annotation></semantics></math></span><span class="katex-html" aria-hidden="true"><span class="strut" style="height: 0.68333em;"></span><span class="strut bottom" style="height: 0.83333em; vertical-align: -0.15em;"></span><span class="base"><span class="mord"><span class="mord mathbf">x</span></span><span class="mrel">∈</span><span class="mord"><span style="margin-right: 0.00773em;" class="mord mathit">R</span><span class="msupsub"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height: 0.151392em;"><span class="" style="top: -2.55em; margin-left: -0.00773em; margin-right: 0.05em;"><span class="pstrut" style="height: 2.7em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mathit mtight">e</span></span></span></span><span class="vlist-s">​</span></span><span class="vlist-r"><span class="vlist" style="height: 0.15em;"></span></span></span></span></span></span></span></span></span>,</p>
<p>where <span class="katex--inline"><span class="katex"><span class="katex-mathml"><math><semantics><mrow><msub><mi>R</mi><mi>m</mi></msub></mrow><annotation encoding="application/x-tex">R_m</annotation></semantics></math></span><span class="katex-html" aria-hidden="true"><span class="strut" style="height: 0.68333em;"></span><span class="strut bottom" style="height: 0.83333em; vertical-align: -0.15em;"></span><span class="base"><span class="mord"><span style="margin-right: 0.00773em;" class="mord mathit">R</span><span class="msupsub"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height: 0.151392em;"><span class="" style="top: -2.55em; margin-left: -0.00773em; margin-right: 0.05em;"><span class="pstrut" style="height: 2.7em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mathit mtight">m</span></span></span></span><span class="vlist-s">​</span></span><span class="vlist-r"><span class="vlist" style="height: 0.15em;"></span></span></span></span></span></span></span></span></span> denotes the regions occupied by ferroelectric/ferromagnetic bodies, and <span class="katex--inline"><span class="katex"><span class="katex-mathml"><math><semantics><mrow><msub><mi>R</mi><mi>e</mi></msub></mrow><annotation encoding="application/x-tex">R_e</annotation></semantics></math></span><span class="katex-html" aria-hidden="true"><span class="strut" style="height: 0.68333em;"></span><span class="strut bottom" style="height: 0.83333em; vertical-align: -0.15em;"></span><span class="base"><span class="mord"><span style="margin-right: 0.00773em;" class="mord mathit">R</span><span class="msupsub"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height: 0.151392em;"><span class="" style="top: -2.55em; margin-left: -0.00773em; margin-right: 0.05em;"><span class="pstrut" style="height: 2.7em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mathit mtight">e</span></span></span></span><span class="vlist-s">​</span></span><span class="vlist-r"><span class="vlist" style="height: 0.15em;"></span></span></span></span></span></span></span></span></span> denotes non-ferroelectric/ferromagnetic region complementary to <span class="katex--inline"><span class="katex"><span class="katex-mathml"><math><semantics><mrow><msub><mi>R</mi><mi>m</mi></msub></mrow><annotation encoding="application/x-tex">R_m</annotation></semantics></math></span><span class="katex-html" aria-hidden="true"><span class="strut" style="height: 0.68333em;"></span><span class="strut bottom" style="height: 0.83333em; vertical-align: -0.15em;"></span><span class="base"><span class="mord"><span style="margin-right: 0.00773em;" class="mord mathit">R</span><span class="msupsub"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height: 0.151392em;"><span class="" style="top: -2.55em; margin-left: -0.00773em; margin-right: 0.05em;"><span class="pstrut" style="height: 2.7em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mathit mtight">m</span></span></span></span><span class="vlist-s">​</span></span><span class="vlist-r"><span class="vlist" style="height: 0.15em;"></span></span></span></span></span></span></span></span></span>. One boundary condition is that the potential is zero at infinity; the other boundary condition is that the normal derivative of the potential is discontinuous at the surface of the bodies and equals to the polarization/magnetization density multiplied by normal vector at the surface. More details of the method can be found in the original paper <a href="http://ieeexplore.ieee.org/document/106342/">here</a>.</p>
<p>In a recent work, we have developed a parallel code that further improves the computational efficiency of the method. In particular, we have reduced the scaling of the boundary integration to <span class="katex--inline"><span class="katex"><span class="katex-mathml"><math><semantics><mrow><mi>O</mi><mo>(</mo><mi>N</mi><mo>)</mo></mrow><annotation encoding="application/x-tex">O(N)</annotation></semantics></math></span><span class="katex-html" aria-hidden="true"><span class="strut" style="height: 0.75em;"></span><span class="strut bottom" style="height: 1em; vertical-align: -0.25em;"></span><span class="base"><span style="margin-right: 0.02778em;" class="mord mathit">O</span><span class="mopen">(</span><span style="margin-right: 0.10903em;" class="mord mathit">N</span><span class="mclose">)</span></span></span></span></span> using a fast multipole method. The code is written on <a href="http://libmesh.github.io/">libMesh</a> (finite element library) and <a href="https://gitlab.inria.fr/solverstack/ScalFMM">ScalFMM</a> (fast multipole method). Please see the paper in the <strong>Algorithm</strong> section for more details of our work.</p>
<h2 id="installation">Installation</h2>
<p><em>1. Install Moose</em></p>
<p>Follow instructions on <a href="http://mooseframework.org/getting-started/">GettingStarted</a> to install Moose Framework. If you meet any troubles during installation, please refer to <a href="https://groups.google.com/forum/#!forum/moose-users">moose-users</a> forum for help.</p>
<br>
<p><em>2. Install Parallel O(N) Fredkin-Koehler solver</em></p>
<ul>
<li>
<p>Download the latest public version</p>
<p><code>git clone https://github.com/xikaij/fredkin-koehler.git</code></p>
</li>
<li>
<p>Compile ScalFMM</p>
<p><code>cd contrib</code></p>
<p><code>./build_scalfmm</code></p>
<p><code>cd ..</code></p>
<p>If you meet any trouble in compiling ScalFMM, please refer to Help and News section on ScalFMM’s GitLab site <a href="https://gitlab.inria.fr/solverstack/ScalFMM">here</a>.</p>
</li>
<li>
<p>Add path to ScalFMM into the Makefile in the top directory. Edit last two <code>app_INCLUDES</code> in the Makefile as follows:</p>
<p><code>app_INCLUDES += -I/your/path/to/fredkin-koehler/contrib/scalfmm/Src</code></p>
<p><code>app_INCLUDES += -I/your/path/to/fredkin-koehler/contrib/scalfmm/build/Src</code></p>
</li>
<li>
<p>Then ‘make’, in the top directory, to compile the code</p>
<p><code>make</code></p>
<p>It will generate the executable <code>fredkin-koehler-opt</code> in the top directory.</p>
</li>
</ul>
<br>
<p><em>3. Run example.</em></p>
<p>An example is provided in the top directory. The input files are</p>
<blockquote>
<p>fredkin-koehler.i</p>
</blockquote>
<blockquote>
<p>poisson.i</p>
</blockquote>
<blockquote>
<p>laplace.i</p>
</blockquote>
<p>and the mesh file is <code>sphere_tet_approx_size0_05.e</code>. An unit magnetization density in the x-direction <span class="katex--inline"><span class="katex"><span class="katex-mathml"><math><semantics><mrow><mrow><mi mathvariant="bold">M</mi></mrow><mo>=</mo></mrow><annotation encoding="application/x-tex">\bold{M}=</annotation></semantics></math></span><span class="katex-html" aria-hidden="true"><span class="strut" style="height: 0.68611em;"></span><span class="strut bottom" style="height: 0.68611em; vertical-align: 0em;"></span><span class="base"><span class="mord"><span class="mord mathbf">M</span></span><span class="mrel">=</span></span></span></span></span> (1, 0, 0) set as the initial condition. Run the application as</p>
<p><code>mpiexec -np NUM_OF_CORES ./fredkin-koehler-opt -i fredkin-koehler.i</code></p>
<p>Replace <code>NUM_OF_CORES</code> by the total number of cores you want to use.</p>
<p>The output files are as follows, which you could use <a href="https://www.paraview.org/">Paraview</a> for visualization.</p>
<blockquote>
<p>fredkin-koehler_out.e      (output of the master app, showing <span class="katex--inline"><span class="katex"><span class="katex-mathml"><math><semantics><mrow><mi>ϕ</mi></mrow><annotation encoding="application/x-tex">\phi</annotation></semantics></math></span><span class="katex-html" aria-hidden="true"><span class="strut" style="height: 0.69444em;"></span><span class="strut bottom" style="height: 0.88888em; vertical-align: -0.19444em;"></span><span class="base"><span class="mord mathit">ϕ</span></span></span></span></span>)</p>
</blockquote>
<blockquote>
<p>fredkin-koehler_out_poisson0.e  (output of the Poisson solver, showing <span class="katex--inline"><span class="katex"><span class="katex-mathml"><math><semantics><mrow><msub><mi>ϕ</mi><mn>1</mn></msub></mrow><annotation encoding="application/x-tex">\phi_1</annotation></semantics></math></span><span class="katex-html" aria-hidden="true"><span class="strut" style="height: 0.69444em;"></span><span class="strut bottom" style="height: 0.88888em; vertical-align: -0.19444em;"></span><span class="base"><span class="mord"><span class="mord mathit">ϕ</span><span class="msupsub"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height: 0.301108em;"><span class="" style="top: -2.55em; margin-left: 0em; margin-right: 0.05em;"><span class="pstrut" style="height: 2.7em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mathrm mtight">1</span></span></span></span><span class="vlist-s">​</span></span><span class="vlist-r"><span class="vlist" style="height: 0.15em;"></span></span></span></span></span></span></span></span></span>)</p>
</blockquote>
<blockquote>
<p>fredkin-koehler_out_laplace0.e  (output of the Laplace solver, showing <span class="katex--inline"><span class="katex"><span class="katex-mathml"><math><semantics><mrow><msub><mi>ϕ</mi><mn>2</mn></msub></mrow><annotation encoding="application/x-tex">\phi_2</annotation></semantics></math></span><span class="katex-html" aria-hidden="true"><span class="strut" style="height: 0.69444em;"></span><span class="strut bottom" style="height: 0.88888em; vertical-align: -0.19444em;"></span><span class="base"><span class="mord"><span class="mord mathit">ϕ</span><span class="msupsub"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height: 0.301108em;"><span class="" style="top: -2.55em; margin-left: 0em; margin-right: 0.05em;"><span class="pstrut" style="height: 2.7em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mathrm mtight">2</span></span></span></span><span class="vlist-s">​</span></span><span class="vlist-r"><span class="vlist" style="height: 0.15em;"></span></span></span></span></span></span></span></span></span>)</p>
</blockquote>
<h2 id="machinery">Machinery</h2>
<p>The code uses <code>MultiApps</code> functionality in Moose. <code>fredkin-koehler.i</code> is the master app, while <code>poisson.i</code> and <code>laplace.i</code> are subapps.</p>
<p><code>poisson.i</code> solves for <span class="katex--inline"><span class="katex"><span class="katex-mathml"><math><semantics><mrow><msub><mi>ϕ</mi><mn>1</mn></msub></mrow><annotation encoding="application/x-tex">\phi_1</annotation></semantics></math></span><span class="katex-html" aria-hidden="true"><span class="strut" style="height: 0.69444em;"></span><span class="strut bottom" style="height: 0.88888em; vertical-align: -0.19444em;"></span><span class="base"><span class="mord"><span class="mord mathit">ϕ</span><span class="msupsub"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height: 0.301108em;"><span class="" style="top: -2.55em; margin-left: 0em; margin-right: 0.05em;"><span class="pstrut" style="height: 2.7em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mathrm mtight">1</span></span></span></span><span class="vlist-s">​</span></span><span class="vlist-r"><span class="vlist" style="height: 0.15em;"></span></span></span></span></span></span></span></span></span>, <code>laplace.i</code> solves for <span class="katex--inline"><span class="katex"><span class="katex-mathml"><math><semantics><mrow><msub><mi>ϕ</mi><mn>2</mn></msub></mrow><annotation encoding="application/x-tex">\phi_2</annotation></semantics></math></span><span class="katex-html" aria-hidden="true"><span class="strut" style="height: 0.69444em;"></span><span class="strut bottom" style="height: 0.88888em; vertical-align: -0.19444em;"></span><span class="base"><span class="mord"><span class="mord mathit">ϕ</span><span class="msupsub"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height: 0.301108em;"><span class="" style="top: -2.55em; margin-left: 0em; margin-right: 0.05em;"><span class="pstrut" style="height: 2.7em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mathrm mtight">2</span></span></span></span><span class="vlist-s">​</span></span><span class="vlist-r"><span class="vlist" style="height: 0.15em;"></span></span></span></span></span></span></span></span></span>, and <code>fredkin-koehler.i</code> contains the final potential <span class="katex--inline"><span class="katex"><span class="katex-mathml"><math><semantics><mrow><mi>ϕ</mi></mrow><annotation encoding="application/x-tex">\phi</annotation></semantics></math></span><span class="katex-html" aria-hidden="true"><span class="strut" style="height: 0.69444em;"></span><span class="strut bottom" style="height: 0.88888em; vertical-align: -0.19444em;"></span><span class="base"><span class="mord mathit">ϕ</span></span></span></span></span> with <span class="katex--inline"><span class="katex"><span class="katex-mathml"><math><semantics><mrow><mi>ϕ</mi><mo>=</mo><msub><mi>ϕ</mi><mn>1</mn></msub><mo>+</mo><msub><mi>ϕ</mi><mn>2</mn></msub></mrow><annotation encoding="application/x-tex">\phi=\phi_1+\phi_2</annotation></semantics></math></span><span class="katex-html" aria-hidden="true"><span class="strut" style="height: 0.69444em;"></span><span class="strut bottom" style="height: 0.88888em; vertical-align: -0.19444em;"></span><span class="base"><span class="mord mathit">ϕ</span><span class="mrel">=</span><span class="mord"><span class="mord mathit">ϕ</span><span class="msupsub"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height: 0.301108em;"><span class="" style="top: -2.55em; margin-left: 0em; margin-right: 0.05em;"><span class="pstrut" style="height: 2.7em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mathrm mtight">1</span></span></span></span><span class="vlist-s">​</span></span><span class="vlist-r"><span class="vlist" style="height: 0.15em;"></span></span></span></span></span><span class="mbin">+</span><span class="mord"><span class="mord mathit">ϕ</span><span class="msupsub"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height: 0.301108em;"><span class="" style="top: -2.55em; margin-left: 0em; margin-right: 0.05em;"><span class="pstrut" style="height: 2.7em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mathrm mtight">2</span></span></span></span><span class="vlist-s">​</span></span><span class="vlist-r"><span class="vlist" style="height: 0.15em;"></span></span></span></span></span></span></span></span></span>.</p>
<p>The code first solves the Poisson equation in <code>poisson.i</code> on the volumetric mesh. Then the volumetric solution (<span class="katex--inline"><span class="katex"><span class="katex-mathml"><math><semantics><mrow><msub><mi>ϕ</mi><mn>1</mn></msub></mrow><annotation encoding="application/x-tex">\phi_1</annotation></semantics></math></span><span class="katex-html" aria-hidden="true"><span class="strut" style="height: 0.69444em;"></span><span class="strut bottom" style="height: 0.88888em; vertical-align: -0.19444em;"></span><span class="base"><span class="mord"><span class="mord mathit">ϕ</span><span class="msupsub"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height: 0.301108em;"><span class="" style="top: -2.55em; margin-left: 0em; margin-right: 0.05em;"><span class="pstrut" style="height: 2.7em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mathrm mtight">1</span></span></span></span><span class="vlist-s">​</span></span><span class="vlist-r"><span class="vlist" style="height: 0.15em;"></span></span></span></span></span></span></span></span></span>) is transfered from sub_app1 (<code>poisson.i</code>) to the master_app (<code>fredkin-koehler.i</code>), and is subsequently transfered from master_app (<code>fredkin-koehler.i</code>) to sub_app2 (<code>laplace.i</code>). The transfers are done using <code>MultiAppCopyTransfer</code> in Moose.</p>
<p>In <code>laplace.i</code>, a boundary mesh is extracted from the volumetric mesh and the boundary mesh is re-partitioned for much better load balancing during boundary integration. The boundary integral is accelerated by a fast multipole method, and results of the integration are assigned on the boundary of the volumetric mesh and serve as Dirichlet boundary condition for a subsequent Laplace solve on the volumetric mesh. The parts for extracting boundary mesh from volumetric mesh, boundary integration, and data transfers between boundary mesh and volumetric mesh is implemented in the <code>BoundaryIntegralFMM</code> object, which is derived from <code>GeneralUserObject</code> in Moose.</p>
<p>The solution of the Laplace equation provides <span class="katex--inline"><span class="katex"><span class="katex-mathml"><math><semantics><mrow><msub><mi>ϕ</mi><mn>2</mn></msub></mrow><annotation encoding="application/x-tex">\phi_2</annotation></semantics></math></span><span class="katex-html" aria-hidden="true"><span class="strut" style="height: 0.69444em;"></span><span class="strut bottom" style="height: 0.88888em; vertical-align: -0.19444em;"></span><span class="base"><span class="mord"><span class="mord mathit">ϕ</span><span class="msupsub"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height: 0.301108em;"><span class="" style="top: -2.55em; margin-left: 0em; margin-right: 0.05em;"><span class="pstrut" style="height: 2.7em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mathrm mtight">2</span></span></span></span><span class="vlist-s">​</span></span><span class="vlist-r"><span class="vlist" style="height: 0.15em;"></span></span></span></span></span></span></span></span></span>, which is then transfered from sub_app2 (<code>laplace.i</code>) to the master_app (<code>fredkin-koehler.i</code>) and added upon values of <span class="katex--inline"><span class="katex"><span class="katex-mathml"><math><semantics><mrow><msub><mi>ϕ</mi><mn>1</mn></msub></mrow><annotation encoding="application/x-tex">\phi_1</annotation></semantics></math></span><span class="katex-html" aria-hidden="true"><span class="strut" style="height: 0.69444em;"></span><span class="strut bottom" style="height: 0.88888em; vertical-align: -0.19444em;"></span><span class="base"><span class="mord"><span class="mord mathit">ϕ</span><span class="msupsub"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height: 0.301108em;"><span class="" style="top: -2.55em; margin-left: 0em; margin-right: 0.05em;"><span class="pstrut" style="height: 2.7em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mathrm mtight">1</span></span></span></span><span class="vlist-s">​</span></span><span class="vlist-r"><span class="vlist" style="height: 0.15em;"></span></span></span></span></span></span></span></span></span> in the master_app to get the final potential <span class="katex--inline"><span class="katex"><span class="katex-mathml"><math><semantics><mrow><mi>ϕ</mi></mrow><annotation encoding="application/x-tex">\phi</annotation></semantics></math></span><span class="katex-html" aria-hidden="true"><span class="strut" style="height: 0.69444em;"></span><span class="strut bottom" style="height: 0.88888em; vertical-align: -0.19444em;"></span><span class="base"><span class="mord mathit">ϕ</span></span></span></span></span>. The solution transfer is done by <code>MultiAppAddTransfer</code>, which is borrowed from <code>MultiAppCopyTransfer</code>. The only difference between them is that <code>MultiAppCopyTransfer</code> uses libMesh function of solution.set(), while <code>MultiAppAddTransfer</code> uses solution.add().</p>
<h2 id="algorithm">Algorithm</h2>
<p>The method paper has details on the implementation and tests of this code: <a href="http://aip.scitation.org/doi/10.1063/1.4960436">An O(N) and parallel approach to integral problems by a kernel-independent fast multipole method: Application to polarization and magnetization of interacting particles. The Journal of Chemical Physics 145, 064307 (2016)</a>.</p>
<h2 id="contributors"><strong>Contributors</strong></h2>
<p><a href="https://www.researchgate.net/profile/Xikai_Jiang">Xikai Jiang</a>, Institute for Molecular Engineering, University of Chicago.</p>
<p>For more details on implementation and usage of this app and any comments, please email <a href="mailto:xikai@uchicago.edu">xikai@uchicago.edu</a>.</p>
<p>The code was built with helps from <a href="https://scholar.google.com/citations?user=0RiauUkAAAAJ&amp;hl=en&amp;oi=ao">John Mangeri</a> at Czech Academy of Sciences, and Moose developers from their <a href="https://groups.google.com/forum/#!forum/moose-users">discussion-forum</a>.</p>
<h2 id="project-supervisor"><strong>Project supervisor</strong></h2>
<p>Olle G. Heinonen, Materials Science Division, Argonne National Laboratory.</p>
<h2 id="license"><strong>License</strong></h2>
<p>The code is open-source and distributed under the GNU GPL license, and may not be used for any commercial or for-profit purposes without our permission. [Date: 01/31/2018]</p>
<h2 id="create-your-own-app">Create your own app</h2>
<p>“Fork Fredkin-Koehler” to create a new MOOSE-based application.</p>
<p>For more information see: <a href="http://mooseframework.org/create-an-app/">http://mooseframework.org/create-an-app/</a></p>

    </div>
  </div>
</body>

</html>
